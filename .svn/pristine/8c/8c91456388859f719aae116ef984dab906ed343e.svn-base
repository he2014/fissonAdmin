<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="stylesheet" type="text/css" href="../../../static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="../../../static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="../../../lib/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="../../../static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="../../../static/h-ui.admin/css/style.css" />
<title>管理员列表</title>
<style type="text/css">
	.row{
		margin-left: 30px;
		margin-right: 0;
		margin-top: 10px;
	}
	.int{
		border: 1px solid #ccc;
	    height: 30px;
	    margin-bottom: 20px;
	}
	.modal-body-pwd{
		color: #e33100;
		margin-left: 30px;
	}
	.font{
		width: 90px;
   		display: inline-block;
	}
</style>
</head>
<body>
<nav class="breadcrumb">
	<i class="Hui-iconfont">&#xe62e;</i> 系统管理
	<span class="c-gray en">&gt;</span> 系统用户管理
	<a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" >
		<i class="Hui-iconfont">&#xe68f;</i>
	</a>
</nav>
<div class="page-container">
	<!-- 查询条件 -->
	<div class="text">
		<!--<input type="text" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'datemax\')||\'%y-%M-%d\'}' })" id="datemin" class="input-text Wdate" style="width:120px;">
		-
		<input type="text" onfocus="WdatePicker({ minDate:'#F{$dp.$D(\'datemin\')}',maxDate:'%y-%M-%d' })" id="datemax" class="input-text Wdate" style="width:120px;">-->
		<input type="text" class="input-text" style="width:250px" placeholder="输入管理员名称" id="" name="">
		<button type="submit" class="btn btn-success" id="" name=""><i class="Hui-iconfont">&#xe665;</i> 查询</button>
	</div>
	<!-- 操心按钮 -->
	<div class="cl pd-5 bg-1 bk-gray mt-20">
		<span class="l">
			<a href="javascript:;" onclick="datadel()" class="btn btn-danger radius">
				<i class="Hui-iconfont">&#xe6e2;</i> 批量删除
			</a>
			<a href="javascript:;" onclick="admin_add()" class="btn btn-primary radius">
				<i class="Hui-iconfont">&#xe600;</i> 添加用户
			</a>
		</span>
		<span class="r">共有数据：<strong>54</strong> 条</span> </div>
		<table class="table table-border table-bordered table-bg  table-hover">
			<thead>
				<tr>
					<th scope="col" colspan="9">员工列表</th>
				</tr>
				<tr class="text-c">
					<th width="25"><input type="checkbox" name="" value=""></th>
					<th width="150">ID</th>
					<th width="180">登录名</th>
					<!--<th width="90">手机</th>
					<th width="150">邮箱</th>-->
					<th width="180">加入时间</th>
					<th>角色</th>
					<!--<th width="100">是否已启用</th>-->
					<th width="180">操作</th>
				</tr>
			</thead>
			<tbody id="UserList">
				<tr class="text-c">
					<td><input type="checkbox" value="1" name=""></td>
					<td>1</td>
					<td>admin</td>
					<td>13000000000</td>
					<td>admin@mail.com</td>
					<td>超级管理员</td>
					<td>2014-6-11 11:11:42</td>
					<td class="td-status"><span class="label label-success radius">已启用</span></td>
					<td class="td-manage"><a style="text-decoration:none" onClick="admin_stop(this,'10001')" href="javascript:;" title="停用"><i class="Hui-iconfont">&#xe631;</i></a> <a title="编辑" href="javascript:;" onclick="admin_edit('管理员编辑','admin-add.html','1','800','500')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6df;</i></a> <a title="删除" href="javascript:;" onclick="admin_del(this,'1')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6e2;</i></a></td>
				</tr>
				<tr class="text-c">
					<td><input type="checkbox" value="2" name=""></td>
					<td>2</td>
					<td>zhangsan</td>
					<td>13000000000</td>
					<td>admin@mail.com</td>
					<td>栏目编辑</td>
					<td>2014-6-11 11:11:42</td>
					<td class="td-status"><span class="label radius">已停用</span></td>
					<td class="td-manage"><a style="text-decoration:none" onClick="admin_start(this,'10001')" href="javascript:;" title="启用"><i class="Hui-iconfont">&#xe615;</i></a> <a title="编辑" href="javascript:;" onclick="admin_edit('管理员编辑','admin-add.html','2','800','500')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6df;</i></a> <a title="删除" href="javascript:;" onclick="admin_del(this,'1')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6e2;</i></a></td>
				</tr>
			</tbody>
		</table>
	</div>
	<!--<div  style="display: none;">-->
		<!-- 用户添加 -->
		<!--<article id="addUser" class="page-container">
				<div class="row cl">
					<span class="font">用户名：</span><input id="un" class="input-user int" type="text" placeholder="用户名" /><br/>
					<span class="font">初始密码：</span><input id="ps" class="input-ps int" type="password" placeholder="请输入密码" />
				</div>
				<div class="modal-body-pwd">
					<span>*</span>密码长度为6-20位，不能是全数字或全字母
				</div>
				<div class="row cl">
					<div class="col-xs-4 col-sm-3 col-xs-offset-7 col-sm-offset-8">
						<div id="SaveBtn" class="btn btn-success radius size-L" style="width: 100%">保 存</div>
					</div>
				</div>
		</article>
	</div>-->
	
	 <div id="addUser" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content radius">
				<div class="modal-header">
					<h3 class="modal-title">添加用户</h3>
					<a class="close" data-dismiss="modal" aria-hidden="true" href="javascript:void();">×</a>
				</div>
				<div class="modal-body">
					<span>用户名：</span><input id="un" class="input-user int" type="text" placeholder="请输入用户名" /><br/>
					<span>初始密码：</span><input id="ps" class="input-ps int" type="text" placeholder="请输入密码" />
				</div>
				<div class="modal-body-pwd">
					<span>*</span>密码长度为6-20位，不能是全数字或全字母
				</div>
				<div class="modal-footer">
					<button class="btn btn-primary size-L" id="SaveBtn">确定</button>
					<button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
				</div>
			</div>
		</div>
	</div>
	<!-- 用户修改 -->
	<!--<div  style="display: none;">
		<article id="editUser" class="page-container">
				<div class="row cl">
					<span class="font">用户id：</span><input id="ui" class="input-userId int" type="text" placeholder="用户id" /><br/>
					<span class="font">用户名：</span><input id="un" class="input-userName int" type="text" placeholder="用户名" /><br/>
					<span class="font">初始密码：</span><input id="ps" class="input-passWord int" type="password" placeholder="请输入密码" />
				</div>
				<div class="modal-body-pwd">
					<span>*</span>密码长度为6-20位，不能是全数字或全字母
				</div>
				<div class="row cl">
					<div class="col-xs-4 col-sm-3 col-xs-offset-7 col-sm-offset-8">
						<div id="SaveBtn" class="btn btn-success radius size-L" style="width: 100%">保 存</div>
					</div>
				</div>
		</article>
	</div>-->
	
	
	<!--<div id="editUser" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
				<div class="modal-body">
					<span class="font">用户id：</span><input id="ui" class="input-userId int" type="text" placeholder="请输入旧密码" /><br/>
					<span class="font">用户名：</span><input id="un" class="input-userName int" type="text" placeholder="请输入新密码" />
					<span class="font">初始密码：</span><input id="ps" class="input-passWord int" type="text" placeholder="请输入新密码" />
				</div>
				<div class="modal-body-pwd">
					<span>*</span>密码长度为6-20位，不能是全数字或全字母
				</div>
				<div >
					<button class="btn btn-primary" id="submitNewpwd">确定</button>
					<button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
				</div>
			</div>
		</div>
	</div>-->
	
	<div id="editUser" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content radius">
				<div class="modal-header">
					<h3 class="modal-title">修改密碼</h3>
					<a class="close" data-dismiss="modal" aria-hidden="true" href="javascript:void();">×</a>
				</div>
				<div class="modal-body">
					<span>旧密码：</span><input id="oldPwd" type="text" placeholder="请输入旧密码" /><br/>
					<span>新密码：</span><input id="newPwd" type="text" placeholder="请输入新密码" />
				</div>
				<div class="modal-body-pwd">
					<span>*</span>密码长度为6-20位，不能是全数字或全字母
				</div>
				<div class="modal-footer">
					<button class="btn btn-primary" id="submitNewpwd">确定</button>
					<button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
				</div>
			</div>
		</div>
	</div>
 
    
   
<script type="text/javascript" src="../../../lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="../../../lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="../../../static/h-ui/js/H-ui.min.js"></script>
<script type="text/javascript" src="../../../static/h-ui.admin/js/H-ui.admin.js"></script>
 <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="../../../lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="../../../lib/datatables/1.10.0/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="../../../lib/laypage/1.2/laypage.js"></script>
<script src="../../js/common.js" type="text/javascript" charset="utf-8"></script>
<!-- 常用公共JS-->
		<script type="text/javascript" src="../../js/util.js"></script>
		<!-- 模板 -->
		<script type="text/javascript" src="../../js/component.js"></script>
		<!--用户表格-->
		<script type="text/javascript" src="../../js/system/userlist.js"></script>

<script type="text/javascript">
//$(function(){
//		getUserList();
//})

/*用户-增加*/
function admin_add(){
//	layer_show('添加用户','addUser','600','250');
	$("#addUser").modal("show")
	//验证新增用户
    $(".size-L").click(function(event) {
//	        alert("1");
			var un = $(".input-user").val();
			var ps = $(".input-ps").val();
			console.log(un);
			var regex = new RegExp(/^(?![^a-zA-Z]+$)(?!\D+$)/);
			if (!un && !ps) {
				$.Huimodalalert('用户名、密码不能为空！', 1500)
			} else if (!un) {
				$.Huimodalalert('用户名不能为空！', 1500)
			} else if (!ps) {
				$.Huimodalalert('密码不能为空！', 1500)
			}

			if (ps && un) {
				if (!regex.test(ps) && !regex.test(un)) {
					$.Huimodalalert('用户名、密码格式不正确！', 1500)
				} else if (!regex.test(ps) && (ps.length < 6 || ps.length > 20)) {
					$.Huimodalalert('密码格式不正确！', 1500)
				} else if ( un.length < 6 ) {
					$.Huimodalalert('用户名格式不正确！', 1500)
				}
				if (regex.test(ps)  && un.length >= 6 && ps.length >= 6 && ps.length <= 20) {
					var data = {
						un: un,
						ps: ps
					}
					postAjax("sysuser/manage/add", data, function(msg) {
						if (msg.code == 0) {
							$.Huimodalalert('新用户保存成功！', 1500)
							$("#addUser").modal("hide");
							user_taable.getUserList(1);

						}
					})
				}
			}
		});
}

/*管理员-删除*/
function admin_del(obj,id){
	var userId = $(".userId").val();
    var datas={
            ui:userId
    };
	layer.confirm('确认要删除吗？',function(index){
		$.ajax({
			type: 'POST',
			url: paths + 'sysuser/del',
			dataType: 'json',
			data:datas,
			success: function(data){
				$(obj).parents("tr").remove();
				layer.msg('已删除!',{icon:1,time:1000});
			},
			error:function(data) {
				console.log(data.msg);
			},
		});
	});
}

/*管理员-编辑*/
function admin_edit(){
//	layer_show('修改用户','editUser','600','300');
	$("#editUser").modal("show")
}
/*管理员-停用*/
function admin_stop(obj,id){
	layer.confirm('确认要停用吗？',function(index){
		//此处请求后台程序，下方是成功后的前台处理……

		$(obj).parents("tr").find(".td-manage").prepend('<a onClick="admin_start(this,id)" href="javascript:;" title="启用" style="text-decoration:none"><i class="Hui-iconfont">&#xe615;</i></a>');
		$(obj).parents("tr").find(".td-status").html('<span class="label label-default radius">已禁用</span>');
		$(obj).remove();
		layer.msg('已停用!',{icon: 5,time:1000});
	});
}

/*管理员-启用*/
function admin_start(obj,id){
	layer.confirm('确认要启用吗？',function(index){
		//此处请求后台程序，下方是成功后的前台处理……
		$(obj).parents("tr").find(".td-manage").prepend('<a onClick="admin_stop(this,id)" href="javascript:;" title="停用" style="text-decoration:none"><i class="Hui-iconfont">&#xe631;</i></a>');
		$(obj).parents("tr").find(".td-status").html('<span class="label label-success radius">已启用</span>');
		$(obj).remove();
		layer.msg('已启用!', {icon: 6,time:1000});
	});
}
//获取用户列表
//function getUserList(type,info){
//	        var datas=$.extend({
//				Page:1,
//				Size:10
//          }, info);
////          console.log(datas)
//          $.ajax({
//				type:"get",
//				url:paths +"sysuser/manage/list",
//				async:true,
//				dataType:'json',
//				data:datas,
//				success:function(data){
//					console.log(data)
//					if(data.code == 0){
//						if(data.dataInfo.list && data.dataInfo.list.length>0){
//							var htmls = getListHtmls(data.dataInfo.list);
//							$("#UserList").html(htmls);
//						}else{
//							$("#UserList").html(' ');
//						}
////						getPageHtmls(data.dataInfo.pageCount,data.dataInfo.page,data.dataInfo.pageSize);
//					}
//				},
//				error:function(e){
//					console.log(e)
//				}
//			});
//}
//处理列表数据
//	function getListHtmls(datas){
//		var htmls =  '';
//		$.each(datas,function(index,item){
//			htmls += '<tr class="text-c"><td><input type="checkbox" value="1" name=""></td><td class="userId">'+item.userId+'</td><td>'+item.loginName+'</td><td>'+getTimes(item.createTime)+'</td><td>超级管理员</td>'+'<td class="td-manage"><a title="编辑" href="javascript:;" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont" onclick="admin_edit()">&#xe6df;</i></a><a title="删除" href="javascript:;" class="ml-7" style="text-decoration:none"><i class="Hui-iconfont" onclick="admin_del()">&#xe6e2;</i></a></td></tr>';
//		})	
//		return htmls;
//	}


</script>
</body>
</html>