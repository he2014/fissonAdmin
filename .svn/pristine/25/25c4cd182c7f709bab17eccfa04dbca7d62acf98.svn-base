$(document).ready(function() {
    $("#functionTable").on("click", "a", function() {
        var id = $(this).parent("td").attr("id") || $(this).parent("td").siblings("td").attr("id");
        var pid = $(this).parent("td").attr("pid") || $(this).parent("td").siblings("td").attr("pid");
        if ($(this).find('i').hasClass("userDelete") && pid) { //删除

        } else if ($(this).find('i').hasClass("userEdit") && pid) { //编辑

        } else { //添加
            layer.open({
                type: 1,
                skin: 'layui-layer-rim', //加上边框
                area: ['600px', '520px'], //宽高
                content: '<div class="modal-content radius">' +
                    '<form role="form">' +
                    '<div class="form name">' +
                    '<label for="name">功能名字：</label>' +
                    '<input type="text" class="input-text radius" id="functionName" placeholder="请输入名称" required="required" >' +
                    '</div>' +
                    '<div class="form id">' +
                    '<label for="functionId">功能id：</label>' +
                    '<input type="text" id="functionId" class="input-text radius" placeholder="请输入功能id" required="required" >' +
                    '</div>' +
                    '<div class="form Pid">' +
                    '<label for="functionPid">所属资源id：</label>' +
                    '<input type="text" id="functionPid" class="input-text radius" placeholder="请输入所属资源id" required="required" >' +
                    '</div>' +
                    '<div class="form flag">' +
                    '<label for="functionFlag">功能标记：</label>' +
                    '<input type="text" id="functionFlag" class="input-text radius" placeholder="请填写功能标记" required="required" >' +
                    '</div>' +
                    '<div class="form type">' +
                    '<label class="control-label" for="functionType">功能类型：</label>' +
                    '<select id="selectError"><option>是0</option><option>否1</option></select>' +
                    '<span class="choose-type">请选择类型</span>' +
                    '</div>' +
                    '<div class="form scope">' +
                    '<label for="functionScope">权限范围：</label>' +
                    '<input type="text" id="functionScope" class="input-text radius" placeholder="请填写权限范围" required="required" >' +
                    '</div>' +
                    '</form>' +
                    '<div class="modal-footer">' +
                    '<button class="btn btn-primary primary _addFunction">确定</button>' +
                    '<button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>' +
                    '</div>' +
                    '</div>',

            });
        }



    })
    $("._addFunction").unbind('click').click(function(event) {
        console.log(1)
        var fn = $("#functionName").val();
        var fid = $("#functionId").val();
        var fpid = $("#functionPid").val();
        var ff = $("#functionFlag").val();
        var fs = $("#functionScope").val();

        if (!fn || !fid || !fpid || !ff || !fs) {
            $.Huimodalalert('信息不能为空！', 1500)
        }
        if (fn && fid && fpid && ff && fs) {
            var data = {
                name: fn,
                flag: ff,
                rid: fpid,
                pt: 1,
                r: fs,
                Id: fid
            }
            postAjax("function/add", data, function(msg) {
                if (msg.code == 0 && msg.dataInfo > 0) {
                    $.Huimodalalert('新功能保存成功！', 1500)
                    layer.close()
                    functiontable.init();
                }
            })
        }
    })


});
